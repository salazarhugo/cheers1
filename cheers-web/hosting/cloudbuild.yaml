steps:
  # Install
  - name: 'gcr.io/cloud-builders/npm'
    args: ['install']
  # Test
  - name: 'gcr.io/cloud-builders/npm'
    args: ['run', 'test:unit']
  # Build
  - name: 'gcr.io/cloud-builders/npm'
    args: ['run', 'build']
  # Deploy
  - name: 'gcr.io/$PROJECT_ID/firebase'
    args: ['deploy', '--only hosting:cheers']

availableSecrets:
  secretManager:
    - versionName: projects/$PROJECT_ID/secrets/NEO4J_URI/versions/latest
      env: 'NEO4J_URI'
    - versionName: projects/$PROJECT_ID/secrets/NEO4J_PASSWORD/versions/latest
      env: 'NEO4J_PASSWORD'
